<template>
  <ul class="list">
    <li v-for="(todo, index) in todos" class="list__todo todo">
      <div class="todo__state state">
        <input class="state__input" type="checkbox" v-bind:id="'todo_'+index" v-model="todo.done">
        <div class="state__overlay"></div>
      </div>
      <label v-bind:for="'todo_'+index" class="todo__text" v-bind:class="{'todo__text--done': todo.done}">{{ todo.name }}</label>
      <a class="todo__action todo__action--edit" v-on:click.prevent="editTodo(index)" href="">
        <svg>
          <use xlink:href="#edit" x="0" y="0" />
        </svg>
      </a>
      <a class="todo__action todo__action--delete" v-on:click.prevent="deleteTodo(index)" href="">
        <svg>
          <use xlink:href="#delete" x="0" y="0" />
        </svg>
      </a>
    </li>
    <li class="list__todo todo" v-if="todosLength <= 0">
      <span class="todo__text">Vous n'avez aucune todo pour l'instant.</span>
    </li>
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display: none;">
      <symbol id="delete" viewBox="0 0 512 512">
        <path d="M464.71,137.981l-15.936-59.92c-1.519-5.717-6.712-9.709-12.628-9.709H332.769C329.818,30.171,297.829,0,258.905,0h-5.809
        c-38.925,0-70.914,30.171-73.865,68.352H147.17c-4.165,0-7.541,3.376-7.541,7.541c0,4.165,3.376,7.541,7.541,7.541h287.428
        l14.864,55.891h-11.598H75.819h-13.28l14.864-55.891h17.726c4.165,0,7.541-3.376,7.541-7.541c0-4.165-3.376-7.541-7.541-7.541
        H75.853c-5.915,0-11.108,3.992-12.628,9.708L47.29,137.982c-1.051,3.953-0.223,8.079,2.27,11.322
        c2.493,3.242,6.269,5.102,10.359,5.102h8.979l27.885,325.136C98.37,498.046,113.572,512,132.144,512h249.395
        c18.572,0,33.774-13.954,35.361-32.458l18.399-214.531c0.356-4.15-2.719-7.802-6.869-8.158c-4.149-0.351-7.802,2.719-8.158,6.869
        l-18.399,214.531c-0.913,10.641-9.654,18.666-20.334,18.666H132.144c-10.68,0-19.422-8.024-20.334-18.665L84.035,154.406h345.613
        l-4.961,57.841c-0.356,4.149,2.719,7.802,6.869,8.158c4.156,0.354,7.802-2.72,8.158-6.869l5.072-59.131h7.297
        c4.09,0,7.865-1.86,10.358-5.102C464.934,146.062,465.761,141.935,464.71,137.981z M231.523,68.352
        C233.282,56.42,243.586,47.231,256,47.231c12.414,0,22.719,9.189,24.478,21.121H231.523z M295.462,66.569
        c-2.646-19.412-19.334-34.42-39.461-34.42c-20.127,0-36.815,15.007-39.462,34.42h-21.992c3.715-29,28.555-51.487,58.549-51.487
        h5.809c29.994,0,54.834,22.488,58.549,51.487H295.462z"/>
        <path d="M177.889,460.307l-23.206-270.579c-0.356-4.149-4.006-7.219-8.158-6.869c-4.149,0.356-7.225,4.009-6.869,8.158
        l23.206,270.579c0.337,3.93,3.632,6.897,7.505,6.897c0.216,0,0.433-0.009,0.653-0.028
        C175.169,468.109,178.245,464.457,177.889,460.307z"/>
        <path d="M365.474,182.86c-4.145-0.352-7.8,2.719-8.157,6.869l-23.206,270.579c-0.356,4.15,2.719,7.802,6.869,8.158
        c0.219,0.019,0.436,0.028,0.652,0.028c3.873,0,7.168-2.967,7.505-6.897l23.206-270.579
        C372.699,186.868,369.624,183.216,365.474,182.86z"/>
        <path d="M256,182.832c-4.165,0-7.541,3.376-7.541,7.541v270.579c0,4.165,3.376,7.541,7.541,7.541c4.165,0,7.541-3.376,7.541-7.541
            V190.373C263.541,186.208,260.165,182.832,256,182.832z"/>
      </symbol>
      <symbol id="edit" viewBox="0 0 55.25 55.25">
        <path d="M52.618,2.631c-3.51-3.508-9.219-3.508-12.729,0L3.827,38.693C3.81,38.71,3.8,38.731,3.785,38.749
        c-0.021,0.024-0.039,0.05-0.058,0.076c-0.053,0.074-0.094,0.153-0.125,0.239c-0.009,0.026-0.022,0.049-0.029,0.075
        c-0.003,0.01-0.009,0.02-0.012,0.03l-3.535,14.85c-0.016,0.067-0.02,0.135-0.022,0.202C0.004,54.234,0,54.246,0,54.259
        c0.001,0.114,0.026,0.225,0.065,0.332c0.009,0.025,0.019,0.047,0.03,0.071c0.049,0.107,0.11,0.21,0.196,0.296
        c0.095,0.095,0.207,0.168,0.328,0.218c0.121,0.05,0.25,0.075,0.379,0.075c0.077,0,0.155-0.009,0.231-0.027l14.85-3.535
        c0.027-0.006,0.051-0.021,0.077-0.03c0.034-0.011,0.066-0.024,0.099-0.039c0.072-0.033,0.139-0.074,0.201-0.123
        c0.024-0.019,0.049-0.033,0.072-0.054c0.008-0.008,0.018-0.012,0.026-0.02l36.063-36.063C56.127,11.85,56.127,6.14,52.618,2.631z
         M51.204,4.045c2.488,2.489,2.7,6.397,0.65,9.137l-9.787-9.787C44.808,1.345,48.716,1.557,51.204,4.045z M46.254,18.895l-9.9-9.9
        l1.414-1.414l9.9,9.9L46.254,18.895z M4.961,50.288c-0.391-0.391-1.023-0.391-1.414,0L2.79,51.045l2.554-10.728l4.422-0.491
        l-0.569,5.122c-0.004,0.038,0.01,0.073,0.01,0.11c0,0.038-0.014,0.072-0.01,0.11c0.004,0.033,0.021,0.06,0.028,0.092
        c0.012,0.058,0.029,0.111,0.05,0.165c0.026,0.065,0.057,0.124,0.095,0.181c0.031,0.046,0.062,0.087,0.1,0.127
        c0.048,0.051,0.1,0.094,0.157,0.134c0.045,0.031,0.088,0.06,0.138,0.084C9.831,45.982,9.9,46,9.972,46.017
        c0.038,0.009,0.069,0.03,0.108,0.035c0.036,0.004,0.072,0.006,0.109,0.006c0,0,0.001,0,0.001,0c0,0,0.001,0,0.001,0h0.001
        c0,0,0.001,0,0.001,0c0.036,0,0.073-0.002,0.109-0.006l5.122-0.569l-0.491,4.422L4.204,52.459l0.757-0.757
        C5.351,51.312,5.351,50.679,4.961,50.288z M17.511,44.809L39.889,22.43c0.391-0.391,0.391-1.023,0-1.414s-1.023-0.391-1.414,0
        L16.097,43.395l-4.773,0.53l0.53-4.773l22.38-22.378c0.391-0.391,0.391-1.023,0-1.414s-1.023-0.391-1.414,0L10.44,37.738
        l-3.183,0.354L34.94,10.409l9.9,9.9L17.157,47.992L17.511,44.809z M49.082,16.067l-9.9-9.9l1.415-1.415l9.9,9.9L49.082,16.067z"/>
      </symbol>
    </svg>
  </ul>
</template>

<script>
export default {
  name: 'Todos',
  computed: {
    todos(){
      return this.$store.getters.todoList;
    },
    todosLength(){
      return this.$store.getters.todoLength;
    }
  },
  methods: {
    editTodo(key){
      this.$store.commit('editTodo', {key: key});
    },
    deleteTodo(key){
      confirm("Êtes-vous sûr de vouloir suprimer cette todo ?") ? this.$store.commit('deleteTodo', {key: key}) : "";
    }
  }
};
</script>

<style scoped lang="scss">
.todo{
  margin-bottom: 10px;
  display: flex;
  align-items: center;

  &__state{
    margin: 0 10px 0 0;
    position: relative;

    .state{
      &__input,
      &__overlay{
        height: 1.6rem;
        width: 1.6rem;
        margin: 0;
      }
      &__input{
        opacity: 0;
        position: absolute;
        z-index: 10;

        &:checked ~ .state__overlay{
          border-color: transparent;
          transition: none;
        }
        &:checked ~ .state__overlay::before,
        &:checked ~ .state__overlay::after{
          transition: opacity .2s;
          opacity: 1;
        }
      }
      &__overlay{
        border: 1px solid #e0e0e0;
        position: relative;
        z-index: 0;
        transition: opacity .2s;

        &::before,
        &::after{
          display: block;
          opacity: 0;
          position: absolute;
          content: "";
          background: #000;
          transform: rotate(45deg);
        }
        &::before{
          height: 14px;
          width: 1px;
          left: 9px;
          top: 2px;
        }
        &::after{
          width: 8px;
          height: 1px;
          top: 11px;
          left: -2px;
        }
      }
    }
  }
  &__text{
    flex: 1;
    transition: opacity .2s;

    &--done{
      opacity: .2;
    }
  }
  &__action{
    display: block;
    font-size: 0;
    margin: 0 0 0 10px;

    svg{
      height: 1.6rem;
      width: 1.6rem;
    }
  }
}
</style>
